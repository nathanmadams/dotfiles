#!/bin/bash
if [ -z $1 ]; then
    echo "A destination box name must be provided"
    exit 1
fi

DEST_BOX=$1
HOME_DIR="/base/data/nadams"
scp -r ~/.ssh/id_rsa.pub root@${DEST_BOX}:/base/store/ssh/ssh_public_root
ssh root@${DEST_BOX} -n "mkdir $HOME_DIR"
ssh root@${DEST_BOX} -n "HOME=$HOME_DIR && cd ~ && git clone git@git.arbor.net:/nadams/dotfiles && cd dotfiles && git submodule init && git submodule update && source ./install.sh"
#echo "Copying files to ${DEST_BOX}:$HOME_DIR"
#scp -r ~/.bashrc ~/.bash ~/.profile ~/.vimrc root@${DEST_BOX}:$HOME_DIR
ssh root@${DEST_BOX} -n "mkdir $HOME_DIR/.ssh/"
scp ~/.ssh/id_rsa.pub ~/.ssh/known_hosts root@${DEST_BOX}:$HOME_DIR/.ssh/
ssh root@${DEST_BOX} -n "chmod -R 600 $HOME_DIR/.ssh"
#ssh root@${DEST_BOX} -n "mkdir $HOME_DIR/bin/"
#scp ~/bin/maketags root@${DEST_BOX}:$HOME_DIR/bin/
